define("local_hlai_grading/ai_grading_integration",["jquery","core/ajax","core/notification"],(function($,Ajax,Notification){function initAIGradingStatus(){if($("body").hasClass("path-mod-assign")){var cmid=new URLSearchParams(window.location.search).get("id");if(cmid){var $table=$("table.generaltable, table.flexible");if(0!==$table.length){var $headerRow=$table.find("thead tr").first();0===$headerRow.find("th.ai-status-header").length&&$headerRow.find('th:contains("Grade")').after('<th class="ai-status-header">AI Status</th>'),$table.find("tbody tr").each((function(){var $row=$(this);if(!($row.find("td.ai-status-cell").length>0)){var userid=$row.data("userid")||$row.find("[data-userid]").data("userid")||function($row){var $link=$row.find('a[href*="userid="]').first();if($link.length>0){var match=$link.attr("href").match(/userid=(\d+)/);if(match)return match[1]}var userid=$row.find("[data-userid]").first().data("userid");if(userid)return userid;return null}($row);if(userid){var $gradeCell=$row.find("td").filter((function(){return $(this).text().match(/\d+\/\d+|\-/)})).first();$gradeCell.length>0&&$gradeCell.after('<td class="ai-status-cell" data-userid="'+userid+'">...</td>')}}})),function(cmid){Ajax.call([{methodname:"local_hlai_grading_get_ai_statuses",args:{cmid:cmid}}])[0].done((function(response){var statuses;statuses=response,$.each(statuses,(function(userid,status){var $cell=$('td.ai-status-cell[data-userid="'+userid+'"]');$cell.length>0&&$cell.html(function(status){if(!status||!status.exists)return'<span class="badge badge-light">-</span>';var html="";switch(status.status){case"draft":html='<span class="badge badge-warning" title="AI Grade: '+status.grade+'">AI Draft</span> ',html+='<a href="'+M.cfg.wwwroot+"/local/hlai_grading/release.php?id="+status.resultid+'" ',html+='class="btn btn-sm btn-primary">Review</a>';break;case"released":html='<span class="badge badge-success" title="Released">AI Released</span>';break;case"rejected":html='<span class="badge badge-secondary">AI Rejected</span>';break;case"pending":html='<span class="badge badge-info">AI Processing</span>';break;case"failed":html='<span class="badge badge-danger">AI Failed</span>'}return html}(status))}))})).fail((function(error){Notification.exception(error)}))}(cmid)}}}}return{init:function(){"loading"===document.readyState?$(initAIGradingStatus):initAIGradingStatus()}}}));

//# sourceMappingURL=ai_grading_integration.min.js.map