{"version":3,"file":"apexcharts_loader.min.js","sources":["../src/apexcharts_loader.js"],"sourcesContent":["/**\n * ApexCharts loader that bypasses AMD detection to avoid SVG.js conflicts.\n *\n * @module local_hlai_grading/apexcharts_loader\n */\ndefine([], function() {\n    let loadPromise = null;\n\n    const restoreAmdFlag = (defineRef, originalAmd) => {\n        if (defineRef) {\n            defineRef.amd = originalAmd;\n        }\n    };\n\n    const load = () => {\n        if (window.ApexCharts) {\n            return Promise.resolve(window.ApexCharts);\n        }\n\n        if (loadPromise) {\n            return loadPromise;\n        }\n\n        loadPromise = new Promise((resolve, reject) => {\n            const baseUrl = window.M && window.M.cfg ? window.M.cfg.wwwroot : '';\n            if (!baseUrl) {\n                loadPromise = null;\n                reject(new Error('Moodle base URL not available for ApexCharts.'));\n                return;\n            }\n\n            const script = document.createElement('script');\n            const defineRef = window.define;\n            const originalAmd = defineRef ? defineRef.amd : undefined;\n\n            // Disable AMD detection for ApexCharts and its bundled SVG.js.\n            if (defineRef) {\n                defineRef.amd = false;\n            }\n\n            script.async = true;\n            script.src = baseUrl + '/local/hlai_grading/vendor/apexcharts.min.js';\n\n            script.onload = () => {\n                restoreAmdFlag(defineRef, originalAmd);\n                if (window.ApexCharts) {\n                    resolve(window.ApexCharts);\n                } else {\n                    loadPromise = null;\n                    reject(new Error('ApexCharts did not register globally.'));\n                }\n            };\n\n            script.onerror = (error) => {\n                restoreAmdFlag(defineRef, originalAmd);\n                loadPromise = null;\n                reject(error);\n            };\n\n            document.head.appendChild(script);\n        });\n\n        return loadPromise;\n    };\n\n    return {\n        load: load,\n    };\n});\n"],"names":["define","loadPromise","restoreAmdFlag","defineRef","originalAmd","amd","load","window","ApexCharts","Promise","resolve","reject","baseUrl","M","cfg","wwwroot","Error","script","document","createElement","undefined","async","src","onload","onerror","error","head","appendChild"],"mappings":"AAKAA,8CAAO,IAAI,eACHC,YAAc,WAEZC,eAAiB,CAACC,UAAWC,eAC3BD,YACAA,UAAUE,IAAMD,oBAuDjB,CACHE,KApDS,IACLC,OAAOC,WACAC,QAAQC,QAAQH,OAAOC,YAG9BP,cAIJA,YAAc,IAAIQ,SAAQ,CAACC,QAASC,gBAC1BC,QAAUL,OAAOM,GAAKN,OAAOM,EAAEC,IAAMP,OAAOM,EAAEC,IAAIC,QAAU,OAC7DH,eACDX,YAAc,UACdU,OAAO,IAAIK,MAAM,wDAIfC,OAASC,SAASC,cAAc,UAChChB,UAAYI,OAAOP,OACnBI,YAAcD,UAAYA,UAAUE,SAAMe,EAG5CjB,YACAA,UAAUE,KAAM,GAGpBY,OAAOI,OAAQ,EACfJ,OAAOK,IAAMV,QAAU,+CAEvBK,OAAOM,OAAS,KACZrB,eAAeC,UAAWC,aACtBG,OAAOC,WACPE,QAAQH,OAAOC,aAEfP,YAAc,KACdU,OAAO,IAAIK,MAAM,4CAIzBC,OAAOO,QAAWC,QACdvB,eAAeC,UAAWC,aAC1BH,YAAc,KACdU,OAAOc,QAGXP,SAASQ,KAAKC,YAAYV,WAGvBhB"}