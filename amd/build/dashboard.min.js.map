{"version":3,"file":"dashboard.min.js","sources":["../src/dashboard.js"],"sourcesContent":["// This file is part of the Moodle plugin.\n// It manages the dashboard interactions and charts.\n\n/**\n * Dashboard JS.\n *\n * @module     local_hlai_grading/dashboard\n */\n\ndefine(['local_hlai_grading/iksha_charts'], function(IkshaCharts) {\n    const renderAdminChart = data => {\n        const chartNode = document.querySelector('#admin-activity-chart');\n        if (!chartNode) {\n            return;\n        }\n\n        IkshaCharts.create('area', '#admin-activity-chart', {\n            height: 260,\n            series: [{\n                name: 'Graded Items',\n                data: data.data,\n            }],\n            xaxis: {\n                categories: data.labels,\n            },\n            colors: [IkshaCharts.colors.primary],\n        });\n    };\n\n    const renderAdminTopCoursesChart = data => {\n        const chartNode = document.querySelector('#admin-top-courses-chart');\n        if (!chartNode) {\n            return;\n        }\n\n        IkshaCharts.create('barHorizontal', '#admin-top-courses-chart', {\n            height: 260,\n            series: [{\n                name: 'Items Graded',\n                data: data.top_courses_data,\n            }],\n            xaxis: {\n                categories: data.top_courses_labels,\n            },\n            colors: [IkshaCharts.colors.info],\n            dataLabels: {enabled: true},\n        });\n    };\n\n    const renderTeacherGradeDistChart = data => {\n        const chartNode = document.querySelector('#teacher-grade-dist-chart');\n        if (!chartNode) {\n            return;\n        }\n\n        IkshaCharts.create('bar', '#teacher-grade-dist-chart', {\n            height: 260,\n            series: [{\n                name: 'Students',\n                data: data.grade_data,\n            }],\n            xaxis: {\n                categories: data.grade_labels,\n                title: {text: 'Score Range (%)'},\n            },\n            colors: [IkshaCharts.colors.success],\n            dataLabels: {enabled: false},\n        });\n    };\n\n    const renderTeacherRubricChart = data => {\n        const chartNode = document.querySelector('#teacher-rubric-chart');\n        if (!chartNode) {\n            return;\n        }\n\n        IkshaCharts.create('barHorizontal', '#teacher-rubric-chart', {\n            height: 260,\n            series: [{\n                name: 'Avg Score (%)',\n                data: data.rubric_data,\n            }],\n            xaxis: {\n                categories: data.rubric_labels,\n                max: 100,\n                title: {text: 'Average Score (%)'},\n            },\n            colors: [IkshaCharts.colors.warning],\n            dataLabels: {enabled: true},\n        });\n    };\n\n    const init = () => {\n        const dataContainer = document.getElementById('hlai-dashboard-data');\n        if (!dataContainer) {\n            return;\n        }\n\n        const rawData = dataContainer.getAttribute('data-chart');\n        if (!rawData) {\n            return;\n        }\n\n        try {\n            const chartData = JSON.parse(rawData);\n\n            IkshaCharts.load().then(() => {\n                // Admin charts.\n                if (chartData.labels) {\n                    renderAdminChart(chartData);\n                }\n                if (chartData.top_courses_labels) {\n                    renderAdminTopCoursesChart(chartData);\n                }\n\n                // Teacher charts.\n                if (chartData.grade_labels) {\n                    renderTeacherGradeDistChart(chartData);\n                }\n                if (chartData.rubric_labels) {\n                    renderTeacherRubricChart(chartData);\n                }\n                return true;\n            }).catch(() => {\n                // Charts failed to load - silent failure.\n                return false;\n            });\n        } catch (e) {\n            // Failed to parse chart data - silent failure.\n        }\n    };\n\n    return {\n        init: init,\n    };\n});\n"],"names":["define","IkshaCharts","init","dataContainer","document","getElementById","rawData","getAttribute","chartData","JSON","parse","load","then","data","labels","querySelector","create","height","series","name","xaxis","categories","colors","primary","top_courses_labels","top_courses_data","info","dataLabels","enabled","renderAdminTopCoursesChart","grade_labels","grade_data","title","text","success","renderTeacherGradeDistChart","rubric_labels","rubric_data","max","warning","renderTeacherRubricChart","catch","e"],"mappings":"AASAA,sCAAO,CAAC,oCAAoC,SAASC,mBA2H1C,CACHC,KAzCS,WACHC,cAAgBC,SAASC,eAAe,2BACzCF,2BAICG,QAAUH,cAAcI,aAAa,iBACtCD,kBAKKE,UAAYC,KAAKC,MAAMJ,SAE7BL,YAAYU,OAAOC,MAAK,KAhGPC,IAAAA,YAkGTL,UAAUM,SAlGDD,KAmGQL,UAlGXJ,SAASW,cAAc,0BAKzCd,YAAYe,OAAO,OAAQ,wBAAyB,CAChDC,OAAQ,IACRC,OAAQ,CAAC,CACLC,KAAM,eACNN,KAAMA,KAAKA,OAEfO,MAAO,CACHC,WAAYR,KAAKC,QAErBQ,OAAQ,CAACrB,YAAYqB,OAAOC,YAsFpBf,UAAUgB,oBAlFSX,CAAAA,OACbT,SAASW,cAAc,6BAKzCd,YAAYe,OAAO,gBAAiB,2BAA4B,CAC5DC,OAAQ,IACRC,OAAQ,CAAC,CACLC,KAAM,eACNN,KAAMA,KAAKY,mBAEfL,MAAO,CACHC,WAAYR,KAAKW,oBAErBF,OAAQ,CAACrB,YAAYqB,OAAOI,MAC5BC,WAAY,CAACC,SAAS,MAmEdC,CAA2BrB,WAI3BA,UAAUsB,cAnEUjB,CAAAA,OACdT,SAASW,cAAc,8BAKzCd,YAAYe,OAAO,MAAO,4BAA6B,CACnDC,OAAQ,IACRC,OAAQ,CAAC,CACLC,KAAM,WACNN,KAAMA,KAAKkB,aAEfX,MAAO,CACHC,WAAYR,KAAKiB,aACjBE,MAAO,CAACC,KAAM,oBAElBX,OAAQ,CAACrB,YAAYqB,OAAOY,SAC5BP,WAAY,CAACC,SAAS,MAmDdO,CAA4B3B,WAE5BA,UAAU4B,eAjDOvB,CAAAA,OACXT,SAASW,cAAc,0BAKzCd,YAAYe,OAAO,gBAAiB,wBAAyB,CACzDC,OAAQ,IACRC,OAAQ,CAAC,CACLC,KAAM,gBACNN,KAAMA,KAAKwB,cAEfjB,MAAO,CACHC,WAAYR,KAAKuB,cACjBE,IAAK,IACLN,MAAO,CAACC,KAAM,sBAElBX,OAAQ,CAACrB,YAAYqB,OAAOiB,SAC5BZ,WAAY,CAACC,SAAS,MAgCdY,CAAyBhC,YAEtB,KACRiC,OAAM,KAEE,IAEb,MAAOC"}